# =============================================================================
# APIs - Enable Required Google Cloud Services
# =============================================================================

resource "google_project_service" "required_apis" {
  for_each = toset([
    # -------------------------------------------------------------------------
    # Infrastructure Manager
    # -------------------------------------------------------------------------
    "config.googleapis.com",

    # -------------------------------------------------------------------------
    # CI/CD
    # -------------------------------------------------------------------------
    "cloudbuild.googleapis.com",

    # -------------------------------------------------------------------------
    # IAM & Security
    # -------------------------------------------------------------------------
    "iam.googleapis.com",
    "iamcredentials.googleapis.com",
    "secretmanager.googleapis.com",

    # -------------------------------------------------------------------------
    # Resource Management
    # -------------------------------------------------------------------------
    "cloudresourcemanager.googleapis.com",
    "serviceusage.googleapis.com",

    # -------------------------------------------------------------------------
    # Storage
    # -------------------------------------------------------------------------
    "storage.googleapis.com",
    "storage-api.googleapis.com",

    # -------------------------------------------------------------------------
    # BigQuery (log sink)
    # -------------------------------------------------------------------------
    "bigquery.googleapis.com",

    # -------------------------------------------------------------------------
    # Logging & Monitoring
    # -------------------------------------------------------------------------
    "logging.googleapis.com",
    "monitoring.googleapis.com",
  ])

  project = var.project_id
  service = each.value

  disable_on_destroy = false
}
